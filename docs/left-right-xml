<!-- -*- SGML -*-
  -  $URL$
  -  $Id$
  -
  -  See left-right-protocol for detailed comments, right now
  -  I'm just working on translating Lisp pseudocode into XML.
  -
  -  Perhaps nested elements that carry IDs for other objects in
  -  this system should use attributes rather than element content?
  -  Could make an argument either way on consistancy.
  -
  -  "bsc" == "business signing context"
  -->

<completely_gratuitous_wrapper_element_to_let_me_run_this_through_xmllint>
    
    <msg type="control_request">
        <self action="create">
            <extension_preference name="name">Launcelot</extension_preference>
            <extension_preference name="quest">Holy Grail</extension_preference>
        </self>
    </msg>
    
    <msg type="control_response">
        <self self_id="42"/>
    </msg>
    
    <msg type="control_request">
        <self action="set" self_id="42">
            <extension_preference name="color">Blue</extension_preference>
            <rekey/>
            <reissue/>
            <revoke/>
            <run_now/>
            <publish_world_now/>
        </self>
    </msg>
    
    <msg type="control_response">
        <self self_id="42"/>
    </msg>
    
    <msg type="control_request">
        <self action="get" self_id="42"/>
    </msg>
    
    <msg type="control_response">
        <self self_id="42">
            <extension_preference name="name">Launcelot</extension_preference>
            <extension_preference name="quest">Holy Grail</extension_preference>
            <extension_preference name="color">Blue</extension_preference>
        </self>
    </msg>
    
    <msg type="control_request">
        <self action="list"/>
    </msg>
    
    <msg type="control_response">
        <self self_id="42">
            <extension_preference name="name">Launcelot</extension_preference>
            <extension_preference name="quest">Holy Grail</extension_preference>
            <extension_preference name="color">Blue</extension_preference>
        </self>
        <self self_id="99">
            <extension_preference name="name">Arthur, King of the Britons</extension_preference>
            <extension_preference name="quest">Holy Grail</extension_preference>
            <extension_preference name="airspeed_velocity_of_an_unladen_swallow">African or European swallow?</extension_preference>
        </self>
    </msg>
    
    <msg type="control_request">
        <self action="destroy" self_id="42"/>
    </msg>
    
    <msg type="control_response">
        <self self_id="42"/>
    </msg>
    
    <!-- ==== -->
    
    <msg type="control_request">
        <bsc action="create" self_id="42">
            <signing_cert>cert1</signing_cert>
            <generate_keypair key_type="rsa" hash_alg="sha1" key_length="2048"/>
        </bsc>
    </msg>
    
    <msg type="control_response">
        <bsc bsc_id="17">
            <pkcs10_cert_request>req</pkcs10_cert_request>
        </bsc>
    </msg>
    
    <msg type="control_request">
        <bsc action="set" self_id="42" bsc_id="17">
            <signing_cert>cert2</signing_cert>
        </bsc>
    </msg>
    
    <msg type="control_response">
        <bsc bsc_id="17"/>
    </msg>
    
    <msg type="control_request">
        <bsc action="get" self_id="42" bsc_id="17"/>
    </msg>
    
    <msg type="control_response">
        <bsc bsc_id="17">
            <signing_cert>cert1</signing_cert>
            <signing_cert>cert2</signing_cert>
            <public_key>key</public_key>
        </bsc>
    </msg>
    
    
    <msg type="control_request">
        <bsc action="list" self_id="42"/>
    </msg>
    
    <msg type="control_response">
        <bsc bsc_id="17">
            <signing_cert>cert1</signing_cert>
            <signing_cert>cert2</signing_cert>
            <public_key>key</public_key>
        </bsc>
    </msg>
    
    <msg type="control_request">
        <bsc action="destroy" self_id="42" bsc_id="17"/>
    </msg>
    
    <msg type="control_response">
        <bsc bsc_id="17"/>
    </msg>
    
    <!-- ==== -->
    
    <msg type="control_request">
        <parent action="create" self_id="42">
            <peer_ta>key</peer_ta>
            <peer_contact uri="uri"/>
            <sia_base uri="sia_base"/>
            <bsc_link id="bsc"/>
            <repository_link id="repository"/>
        </parent>
    </msg>
    
    <msg type="control_response">
        <parent parent_id="666"/>
    </msg>
    
    <msg type="control_request">
        <parent action="set" self_id="42" parent_id="666">
            <peer_ta>key</peer_ta>
            <peer_contact uri="uri"/>
            <sia_base uri="sia_base"/>
            <bsc_link id="bsc"/>
            <repository_link id="repository"/>
            <rekey/>
            <reissue/>
            <revoke/>
        </parent>
    </msg>
    
    <msg type="control_response">
        <parent parent_id="666"/>
    </msg>
    
    <msg type="control_request">
        <parent action="get" self_id="42" parent_id="666"/>
    </msg>
    
    <msg type="control_response">
        <parent parent_id="666">
            <peer_ta>key</peer_ta>
            <peer_contact uri="uri"/>
            <sia_base uri="sia_base"/>
            <bsc_link id="bsc"/>
            <repository_link id="repository"/>
        </parent>
    </msg>
    
    <msg type="control_request">
        <parent action="list" self_id="42"/>
    </msg>
    
    <msg type="control_response">
        <parent parent_id="666">
            <peer_ta>key</peer_ta>
            <peer_contact uri="uri"/>
            <sia_base uri="sia_base"/>
            <bsc_link id="bsc"/>
            <repository_link id="repository"/>
        </parent>
    </msg>
    
    <msg type="control_request">
        <parent action="destroy" self_id="42" parent_id="666"/>
    </msg>
    
    <msg type="control_response">
        <parent parent_id="666"/>
    </msg>
    
    <!-- ==== -->
    
    <msg type="control_request">
        <child action="create" self_id="42">
            <peer_ta>key</peer_ta>
            <bsc_link id="bsc"/>
            <child_db_id id="child_db_id"/>
        </child>
    </msg>
    
    <msg type="control_response">
        <child child_id="3"/>
    </msg>
    
    <msg type="control_request">
        <child action="set" self_id="42" child_id="3">
            <peer_ta>key</peer_ta>
            <bsc_link id="bsc"/>
            <child_db_id id="child_db_id"/>
            <reissue/>
        </child>
    </msg>
    
    <msg type="control_response">
        <child child_id="3"/>
    </msg>
    
    <msg type="control_request">
        <child action="get" self_id="42" child_id="3"/>
    </msg>
    
    <msg type="control_response">
        <child child_id="3">
            <peer_ta>key</peer_ta>
            <bsc_link id="bsc"/>
            <child_db_id id="child_db_id"/>
        </child>
    </msg>
    
    <msg type="control_request">
        <child action="list" self_id="42"/>
    </msg>
    
    <msg type="control_response">
        <child child_id="3">
            <peer_ta>key</peer_ta>
            <bsc_link id="bsc"/>
            <child_db_id id="child_db_id"/>
        </child>
    </msg>
    
    <msg type="control_request">
        <child action="destroy" self_id="42" child_id="3"/>
    </msg>
    
    <msg type="control_response">
        <child child_id="3"/>
    </msg>
    
    <!-- ==== -->
    
    <msg type="control_request">
        <repository action="create" self_id="42">
            <peer_contact uri="uri"/>
            <peer_ta>key</peer_ta>
            <bsc_link id="bsc"/>
        </repository>
    </msg>
    
    <msg type="control_response">
        <repository repository_id="120"/>
    </msg>
    
    <msg type="control_request">
        <repository action="set" self_id="42" repository_id="120">
            <peer_contact uri="uri"/>
            <peer_ta>key</peer_ta>
            <bsc_link id="bsc"/>
        </repository>
    </msg>
    
    <msg type="control_response">
        <repository repository_id="120"/>
    </msg>
    
    <msg type="control_request">
        <repository action="get" self_id="42" repository_id="120"/>
    </msg>
    
    <msg type="control_response">
        <repository repository_id="120">
            <peer_contact uri="uri"/>
            <peer_ta>key</peer_ta>
            <bsc_link id="bsc"/>
        </repository>
    </msg>
    
    <msg type="control_request">
        <repository action="list" self_id="42"/>
    </msg>
    
    <msg type="control_response">
        <repository repository_id="120">
            <peer_contact uri="uri"/>
            <peer_ta>key</peer_ta>
            <bsc_link id="bsc"/>
        </repository>
    </msg>
    
    <msg type="control_request">
        <repository action="destroy" self_id="42" repository_id="120"/>
    </msg>
    
    <msg type="control_response">
        <repository repository_id="120"/>
    </msg>
    
    <!-- ==== -->
    
    <msg type="control_request">
        <route_origin action="create" self_id="42"/>
    </msg>
    
    <msg type="control_response">
        <route_origin route_origin_id="88"/>
    </msg>
    
    <msg type="control_request">
        <route_origin action="set" self_id="42" route_origin_id="88">
            <suppress_publication/>
            <as_number   asn="12345"/>
            <ipv4_prefix min="10.0.0.44"    len="32"/>
            <ipv4_range  min="10.2.0.6"     max="10.2.0.77"/>
            <ipv6_prefix min="2002:a00::"   len="48"/>
            <ipv6_range  min="2002:a02:6::" max="2002:a02:4d::"/>
        </route_origin>
    </msg>
    
    <msg type="control_response">
        <route_origin route_origin_id="88"/>
    </msg>
    
    <msg type="control_request">
        <route_origin action="get" self_id="42" route_origin_id="88"/>
    </msg>
    
    <msg type="control_response">
        <route_origin route_origin_id="88">
            <as_number   asn="12345"/>
            <ipv4_prefix min="10.0.0.44"    len="32"/>
            <ipv4_range  min="10.2.0.6"     max="10.2.0.77"/>
            <ipv6_prefix min="2002:a00::"   len="48"/>
            <ipv6_range  min="2002:a02:6::" max="2002:a02:4d::"/>
        </route_origin>
    </msg>
    
    <msg type="control_request">
        <route_origin action="list" self_id="42"/>
    </msg>
    
    <msg type="control_response">
        <route_origin route_origin_id="88">
            <as_number   asn="12345"/>
            <ipv4_prefix min="10.0.0.44"    len="32"/>
            <ipv4_range  min="10.2.0.6"     max="10.2.0.77"/>
            <ipv6_prefix min="2002:a00::"   len="48"/>
            <ipv6_range  min="2002:a02:6::" max="2002:a02:4d::"/>
        </route_origin>
    </msg>
    
    <msg type="control_request">
        <route_origin action="destroy" self_id="42" route_origin_id="88"/>
    </msg>
    
    <msg type="control_response">
        <route_origin route_origin_id="88"/>
    </msg>
    
    <!-- ==== -->
    <!-- ==== -->
    
    <msg type="data_request">
        <list_resources self_id="42" child_id="id"/>
    </msg>
    
    <msg type="data_response">
        <list_resources self_id="42" child_id="id" valid_until="2008_04_01T00:00:00Z">
            <resource_class>
                <ipv4_prefix min="10.0.0.44" len="32"/>
                <ipv4_prefix min="10.3.0.44" len="32"/>
                <ipv6_prefix min="fe80:dead:beef::" len="48"/>
                <as_number   asn="666"/>
            </resource_class>
            <resource_class subject_name="wombats are us">
                <subset_ipv4_prefix min="10.0.0.0"         len="8"/>
                <ipv4_prefix        min="10.2..0.6"        len="32"/>
                <ipv6_prefix        min="fe80:dead:beef::" len="48"/>
                <ipv6_range         min="fe80:dead:beef::" max="fe80:dead:beef::49"/>
                <as_number          asn="666"/>
            </resource_class>
        </list_resources>
    </msg>
    
    <!-- === -->
    
    <msg type="error">
        <report_error self_id="42" error_code="your_hair_is_on_fire">bag_of_data</report_error>
    </msg>
    
</completely_gratuitous_wrapper_element_to_let_me_run_this_through_xmllint>

# $Id$

VERSION = 0.7
STAMP	= POW-${VERSION}/build/.timestamp

SOURCES = POW-${VERSION}/lib/__init__.py	\
	  POW-${VERSION}/lib/_der.py		\
	  POW-${VERSION}/lib/_simpledb.py	\
	  POW-${VERSION}/lib/pkix.py		\
	  POW-${VERSION}/setup.py		\
	  POW-${VERSION}/cfgparse.py		\
	  POW-${VERSION}/dumpasn1.cfg		\
	  POW-${VERSION}/POW.c


CFLAGS	= @CFLAGS@
LDFLAGS = @LDFLAGS@
LIBS	= @LIBS@ -lssl -lcrypto

all: ${STAMP}

${STAMP}: ${SOURCES}
	cd POW-${VERSION}; AC_CFLAGS='${CFLAGS}' AC_LDFLAGS='${LDFLAGS}' AC_LIBS='${LIBS}' @PYTHON@ setup.py build
	ln -sf POW-${VERSION}/build/lib.* buildlib
	touch $@

clean:
	rm -rf POW-${VERSION}/build buildlib

install:
	@echo Not attempting to install modified POW, if you want that, do it yourself

test:
	@true

distclean: clean
	rm -f POW-${VERSION}/*.pyc
	rm -f Makefile

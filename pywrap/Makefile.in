# $Id$

OPENSSL_LIBDIR	= ${abs_top_builddir}/openssl/openssl
OPENSSL_SO_GLOB	= @OPENSSL_SO_GLOB@

PYWRAP_LIBDIR	= @PYWRAP_LIBDIR@
PYWRAP_LIBS	= ${OPENSSL_LIBDIR}/${OPENSSL_SO_GLOB}

CFLAGS		= @CFLAGS@
LDFLAGS		= @LDFLAGS@ -L${abs_top_builddir}/openssl/openssl -Wl,-rpath,${PYWRAP_LIBDIR}
LIBS		= -lssl -lcrypto

PYTHON		= @PYTHON@
INSTALL		= @INSTALL@ -m 555 

prefix		= @prefix@
exec_prefix	= @exec_prefix@
datarootdir	= @datarootdir@
datadir		= @datadir@
localstatedir	= @localstatedir@
sharedstatedir	= @sharedstatedir@
sysconfdir	= @sysconfdir@
bindir		= @bindir@
sbindir		= @sbindir@
libexecdir	= @libexecdir@
libdir		= @libdir@

abs_top_srcdir	 = @abs_top_srcdir@
abs_top_builddir = @abs_top_builddir@

all: pywrap

pywrap: pywrap.c
	AC_CFLAGS='${CFLAGS}' AC_LDFLAGS='${LDFLAGS}' AC_LIBS='${LIBS}' ${PYTHON} build.py

clean:
	rm -f *.o pywrap

test:
	@true

distclean: clean
	rm -f Makefile

install: all
	${INSTALL} pywrap ${DESTDIR}${sbindir}
	${INSTALL} -d ${DESTDIR}${PYWRAP_LIBDIR}
	${INSTALL} ${PYWRAP_LIBS} ${DESTDIR}${PYWRAP_LIBDIR}

deinstall uninstall:
	rm -rf ${DESTDIR}${sbindir}/pywrap ${DESTDIR}${PYWRAP_LIBDIR}

# $Id$
#
# @configure_input@

abs_top_srcdir	 = @abs_top_srcdir@
abs_top_builddir = @abs_top_builddir@
srcdir=@srcdir@
prefix=@prefix@
exec_prefix=@exec_prefix@
datarootdir=@datarootdir@
datadir=@datadir@
localstatedir=@localstatedir@
sharedstatedir=@sharedstatedir@
bindir=@bindir@
sbindir=@sbindir@
libexecdir=@libexecdir@

INSTALL = @INSTALL@
WSGI_DAEMON_PROCESS=@WSGI_DAEMON_PROCESS@
WSGI_PROCESS_GROUP=@WSGI_PROCESS_GROUP@
RCYNIC_HTML_DIR=@RCYNIC_HTML_DIR@

INSTDIR=${DESTDIR}$(datarootdir)/rpki

# automatically built sources
BUILD=apache.conf

all: $(BUILD)

clean:
	@true

distclean: clean
	rm -f $(BUILD)
	rm -f Makefile

edit = sed \
	     -e 's|@INSTDIR[@]|$(INSTDIR)|g' \
	     -e 's|@WSGI_DAEMON_PROCESS[@]|$(WSGI_DAEMON_PROCESS)|' \
	     -e 's|@WSGI_PROCESS_GROUP[@]|$(WSGI_PROCESS_GROUP)|' \
	     -e 's|@RCYNIC_HTML_DIR[@]|$(RCYNIC_HTML_DIR)|'

apache.conf: $(srcdir)/apache.conf.in Makefile
	$(edit) $@.in > $@

install: all

deinstall uninstall:
	rm -rf $(INSTDIR)/media $(INSTDIR)/wsgi

test:
	@true

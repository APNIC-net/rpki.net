# $Id$

NAME = find_roa

BIN = ${NAME}
SRC = ${NAME}.c
OBJ = ${NAME}.o

CFLAGS = @CFLAGS@
LDFLAGS = @LDFLAGS@
LIBS = @LIBS@

INSTALL		= @INSTALL@ -m 555 

prefix		= @prefix@
exec_prefix	= @exec_prefix@
datarootdir	= @datarootdir@
datadir		= @datadir@
localstatedir	= @localstatedir@
sharedstatedir	= @sharedstatedir@
sysconfdir	= @sysconfdir@
bindir		= @bindir@
sbindir		= @sbindir@
libexecdir	= @libexecdir@
libdir		= @libdir@

abs_top_srcdir	 = @abs_top_srcdir@
abs_top_builddir = @abs_top_builddir@

all: ${BIN}

clean:
	rm -rf ${BIN} ${OBJ} ${BIN}.dSYM

${BIN}: ${SRC}
	${CC} ${CFLAGS} -o $@ ${SRC} ${LDFLAGS} ${LIBS}


ROA_DIR = ${abs_top_builddir}/rcynic/rcynic-data/authenticated

TEST_ARGS = ${ROA_DIR} 10.3.0.44 10.2.0.6 10.0.0.0/24

test: ${BIN}
#	if test -d ${ROA_DIR}; then ./${BIN} ${TEST_ARGS} ; else :; fi
	if test -d ${ROA_DIR}; then sh ./test_roa.sh ${TEST_ARGS} ; else :; fi

install: all
	if test -d ${DESTDIR}${bindir} ; then :; else ${INSTALL} -d ${DESTDIR}${bindir}; fi
	${INSTALL} ${BIN} ${DESTDIR}${bindir}

deinstall uninstall:
	rm -f ${DESTDIR}${bindir}/${BIN}

distclean: clean
	rm -rf hashed-pem-dir
	rm -f Makefile

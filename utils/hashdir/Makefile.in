# $Id$

NAME = hashdir

BIN = ${NAME}
SRC = ${NAME}.c
OBJ = ${NAME}.o

CFLAGS = @CFLAGS@
LDFLAGS = @LDFLAGS@
LIBS = @LIBS@

INSTALL		= @INSTALL@ -m 555 

prefix		= @prefix@
exec_prefix	= @exec_prefix@
datarootdir	= @datarootdir@
datadir		= @datadir@
localstatedir	= @localstatedir@
sharedstatedir	= @sharedstatedir@
sysconfdir	= @sysconfdir@
bindir		= @bindir@
sbindir		= @sbindir@
libexecdir	= @libexecdir@
libdir		= @libdir@

abs_top_srcdir	 = @abs_top_srcdir@
abs_top_builddir = @abs_top_builddir@

all: ${BIN}

clean::
	rm -f ${BIN} ${OBJ}

${BIN}: ${SRC}
	${CC} ${CFLAGS} -o $@ ${SRC} ${LDFLAGS} ${LIBS}

INPUT  = ${abs_top_builddir}/rcynic/rcynic-data/authenticated
OUTPUT = hashed-pem-dir

test: ${BIN}
	if test -d ${INPUT}; then rm -rf ${OUTPUT} && mkdir ${OUTPUT} && ./hashdir ${INPUT} ${OUTPUT}; else :; fi

clean::
	rm -rf ${OUTPUT}

install: all
	${INSTALL} ${BIN} ${DESTDIR}${bindir}

deinstall uninstall:
	rm -f ${DESTDIR}${bindir}/${BIN}

distclean: clean
	rm -f Makefile

# $Id$

NAME = print_rpki_manifest

BIN = ${NAME}
SRC = ${NAME}.c
OBJ = ${NAME}.o

CFLAGS = @CFLAGS@
LDFLAGS = @LDFLAGS@
LIBS = @LIBS@

INSTALL		= @INSTALL@ -m 555 

prefix		= @prefix@
exec_prefix	= @exec_prefix@
datarootdir	= @datarootdir@
datadir		= @datadir@
localstatedir	= @localstatedir@
sharedstatedir	= @sharedstatedir@
sysconfdir	= @sysconfdir@
bindir		= @bindir@
sbindir		= @sbindir@
libexecdir	= @libexecdir@
libdir		= @libdir@

abs_top_srcdir	 = @abs_top_srcdir@
abs_top_builddir = @abs_top_builddir@

all: ${BIN}

clean:
	rm -rf ${BIN} ${OBJ} ${BIN}.dSYM

${BIN}: ${SRC}
	${CC} ${CFLAGS} -o $@ ${SRC} ${LDFLAGS} ${LIBS}

MANIFEST_DIR = ${abs_top_builddir}/rpkid/tests/smoketest.dir/publication

test: all
	-date -u +'now:            %Y%m%d%H%M%SZ'
	if test -d ${MANIFEST_DIR}; then find ${MANIFEST_DIR} -type f -name '*.mnf' -print -exec ./${BIN} {} \; ; else :; fi

install: all
	if test -d ${DESTDIR}${bindir} ; then :; else ${INSTALL} -d ${DESTDIR}${bindir}; fi
	${INSTALL} ${BIN} ${DESTDIR}${bindir}

deinstall uninstall:
	rm -f ${DESTDIR}${bindir}/${BIN}

installation-manifest:
	echo >>${abs_top_builddir}/installation-manifest F %%BINDIR%%/${BIN}

distclean: clean
	rm -f Makefile
